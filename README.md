<p align="center"><image src="https://skillicons.dev/icons?i=next"></p>
<h1 align="center"><span style="color: #1069da;">NextJS</span> Template</h1>
<p align="center">The boilerplate you need for your <span style="color: #1069da; font-weight: bold;">NextJS</span> Project</p>

<p align="center">
  <a aria-label="NPM Version" href="https://github.com/joni0108/t-nextjs">
    <img alt="" src="https://img.shields.io/github/v/release/joni0108/t-nextjs?label=RELEASE&logo=github&style=for-the-badge&color=0470FF&logoColor=white">
  </a>
  <a aria-label="Test Passing Status" href="https://github.com/joni0108/t-nextjs">
    <img alt="GitHub Actions Workflow Status" src="https://img.shields.io/github/actions/workflow/status/joni0108/t-npm-package/test.yml?style=for-the-badge&logo=vitest&logoColor=white&label=TESTS">
  </a>
  <a aria-label="Bundle Size" href="https://github.com/joni0108/t-nextjs">
    <img alt="GitHub repo size" src="https://img.shields.io/github/repo-size/joni0108/t-nextjs?style=for-the-badge&color=B3CAFF">
  </a>
</p>
<p align="center">
  <a href="https://github.com/joni0108/t-nextjs?tab=readme-ov-file#docs" style="color: #1069da">Docs</a> | 
  <a href="https://github.com/joni0108/t-nextjs" style="color: #1069da">GitHub</a> | 
  <a href="https://github.com/joni0108/t-nextjs/issues" style="color: #1069da">Issues</a>
</p>

## üëÄ Features

<ul>

<div style="display: flex; flex-direction: column; gap: 2px">
<li>
<div style="display: flex; gap: 10px; align-items: center">
<image src="https://skillicons.dev/icons?i=pnpm" style="width: 16px; padding-left: 2px">
<a style="color: #1069da; font-weight: bold" href="https://nextjs.org/docs">
Pnpm</a> 
- Using pnpm as packager loader, for its capabilities and speed compared to npm.
</div>
</li>

<div style="display: flex; flex-direction: column; gap: 2px">
<li>
<div style="display: flex; gap: 10px; align-items: center">
<image src="https://skillicons.dev/icons?i=next" style="width: 16px; padding-left: 2px">
<a style="color: #1069da; font-weight: bold" href="https://nextjs.org/docs">
NextJS</a> 
- With <strong>App Routing,</strong> NextJS powering full stack.
</div>
</li>

<li>
<div style="display: flex; gap: 10px; align-items: center">
<image src="https://skillicons.dev/icons?i=react" style="width: 16px; padding-left: 2px"">
<a style="color: #1069da; font-weight: bold" href="https://react.dev/">
React</a> 
- The core of NextJS, allows the creation of dynamic web applications.
</div>
</li>

<li>
<div style="display: flex; gap: 10px; align-items: center">
<image src="https://skillicons.dev/icons?i=tailwind" style="width: 16px; padding-left: 2px"">
<a style="color: #1069da; font-weight: bold" href="https://tailwindcss.com/docs/installation">
Tailwind CSS</a> 
- A utility-first class framework for rapid UI dev using in-line utility classes.
</div>
</li>

<li>
<div style="display: flex; gap: 7px; align-items: center">
üõ°Ô∏è
<a style="color: #1069da; font-weight: bold" href="https://biomejs.dev/guides/getting-started/">
BiomeJS</a> 
- Formatting and Lint library, for clean and consistent codebase styling habits.
</div>
</li>

<li>
<div style="display: flex; gap: 7px; align-items: center">
üê∫
<a style="color: #1069da; font-weight: bold" href="https://github.com/typicode/husky">
Husky</a> 
- Run scripts before each commit, so you send only safe code to the repo.
</div>
</li>

<li>
<div style="display: flex; gap: 8px; align-items: center">
<image src="https://skillicons.dev/icons?i=github" style="width: 16px; padding-left: 2px"">
<a style="color: #1069da; font-weight: bold" href="https://docs.github.com/en/actions">
Github Actions</a> 
- Automated scripts runs to make sure the code meets the repo rules.
</div>
</li>

<li>
<div style="display: flex; gap: 8px; align-items: center">
<image src="https://skillicons.dev/icons?i=vitest" style="width: 16px; padding-left: 2px"">
<a style="color: #1069da; font-weight: bold" href="https://vitest.dev/">
Vitest</a> 
- The quickest testing framework, configured with react & converage plugins.
</div>
</li>

<li>
<div style="display: flex; gap: 7px; align-items: center">
üîè
<a style="color: #1069da; font-weight: bold" href="https://clerk.com/">
Clerk Auth</a> 
- The modern and secure authentication service your webapp will need.
</div>
</li>

<li>
<div style="display: flex; gap: 7px; align-items: center">
üìß
<a style="color: #1069da; font-weight: bold" href="https://resend.com/">
Resend</a> 
- The easier but reliable emailing service, with a very great free plan.
</div>
</li>

<li>
<div style="display: flex; gap: 8px; align-items: center">
<image src="https://skillicons.dev/icons?i=firebase" style="width: 16px; padding-left: 2px"">
<a style="color: #1069da; font-weight: bold" href="https://firebase.google.com/">
Firestore</a> 
- From firebase aka Google, top service for hosting your user files.
</div>
</li>

<li>
<div style="display: flex; gap: 8px; align-items: center">
<image src="https://skillicons.dev/icons?i=mongodb" style="width: 16px; padding-left: 2px"">
<a style="color: #1069da; font-weight: bold" href="https://www.mongodb.com/">
MongoDB</a> 
- A reliable non-sql database for hosting anything, including a SaaS company.
</div>
</li>

<li>
<div style="display: flex; gap: 8px; align-items: center">
<image src="https://th.bing.com/th/id/OIP.PmUzZ3m4jRMeN0zX5cfREQAAAA?rs=1&pid=ImgDetMain" style="width: 16px; padding-left: 2px"">
<a style="color: #1069da; font-weight: bold" href="https://gemini.google.com/app?hl=en-GB">
Gemini AI</a> 
- The AI solutions your app needs, now easier thru our package <a style="color: #1069da" href="https://github.com/joni0108/codixfy-gemini-npm">@codixfy/gemini.</a>
</div>
</li>

<li>
<div style="display: flex; gap: 8px; align-items: center">
<image src="https://www.codixfy.com/images/icon-light.ico" style="width: 16px; padding-left: 2px"">
<a style="color: #1069da; font-weight: bold" href="https://github.com/joni0108/codixfy-ui">
Codixfy UI</a> 
- Modern react ui components library, with design inspired on<a style="color: #1069da" href="https://preline.co/index.html"> Preline UI. (under-development) </a>
</div>
</li>

<li>
<div style="display: flex; gap: 7px; align-items: center">
üìß
<a style="color: #1069da; font-weight: bold" href="#custom-hooks">
Custom Hooks</a> 
- A pack with common hooks for web applications projects. See docs.
</div>
</li>
</div>

</ul>

## üßê Why this template?

> Why shouln't I just create my own project from scratch?

It's all about your time, you will save the time of installing all dependencies, configuring them, make them compatible, and test them, which can go between **4 hours** to **over 10 hours** depending on your skills.

> [!NOTE]
> Even if all the packages installed solve common issues and tasks of a full stack web application, you will be able to remove any of them. The instructions are on the docs.

## üí® Quickstart

### ‚¨áÔ∏è Downloading

#### By forking the repository (recommended)
This is the easies way to get started, and the way I recommend you to do it. You just simply need to:

1. Click on the `fork` button and give it a name (or keep the same).
2. From your forked version, click on the `use this template` button, and then click on `create new repository`.

This will create a new repository with all the files of this repository. Now you can start configuring your github, and jump to the local installation.

3. Click on the `code` button and copy the url. It is something like `https://github.com/<username>/<repository>.git`.
4. Go to your computer, at the folder you want to save the project in, and open a new terminal.
5. Paste down the line below, and click enter.

```bash
git clone <your url>
```

You are all set, you have the template in a new project and ready to be configured.

#### By downloading the files
You can instead, download all the source files and create your project from them.

1. Click on the `code` button and then click on `Download ZIP`.
2. Save the ZIP file on your workspace folder.
3. Right click and unzip the folder.

Done, you have all the files on your desktop, now you can start editing them, and then configure the repository your own.

### ‚öôÔ∏è Configurations

> [!WARNING]
> This repository uses `pnpm` package loader, so it will be installed on your machine. Do not worry, you can choose to use the default npm on your other projects with no extra configurations.

#### Packages Installation

1. Install all the packages, and run all the initial checks using the code line below:

```bash
npm run init
```

#### Info Configurations
The project includes some information you need to modify for your project, start by:

2. Going to `package.json` file and modify the name and version of the project.
3. Go to `@/config.ts` and modify all the values matching your project information.

#### Adding the environmental variables
At this point you are almost all set, just need to add all the environmental variables related with the services you will be using.

4. Go to `.demo.env` file and check what environmental variables you will need.
5. Create a file called `.env.local` and copy all the variables names and the values (you should get the values following the service docs, it will be below).
6. That's it.

> [!CAUTION]
> Your environmental variables (mostly secret keys) should not be shared with anyone, the file is already ignore by github, so it will be only at your computer. Sharing it with anyone, or leaking it by hard-writting them on your client code could result on theft, attacks, and over-usage of the service by cyber criminals.

You are all set, now you can run some commands to verify the installation went well. If one of the comnmands fail (commonly the tests), you should check what did you did wrong.

> [!TIP]
> The most common failure case on this installation is because of an environmental variable not well configured, so that could be your first place to look.

1. Verify the linters and formatters by using:

```bash
pnpm format:fix
```

then,

```bash
pnpm lint
```

2. Run all the demo and services test suits by calling:

```bash
pnpm test
```

If everything went well, you are all set!

## üõ£Ô∏è Roadmap
- [x] Add all the initial dependencies & configure them
- [x] Add all the scripts, including testing and linting.
- [x] Create the folder structure
- [x] Create the `config.ts` file and other constants.
- [x] Finish configuring dev dependencies
- [x] Create the github actions
- [x] Add 100% coverage. And update the minimum threshold.
- [x] Create the `SEO` object and inject it to the layout
- [x] Add the `ThemeContext` and implement them.
- [x] Add `tw-merge` dependency.
- [x] Add the custom hooks.
- [x] Prepare example pages, including landing, login protected, onboarding, and organizarion role protected routes.
- [x] Add `Clerk Auth` and configure it.
- [ ] Add `Resend` and configure it.
- [ ] Add and configure `Firestore` from firebase.
- [ ] Create masking route/firebase auth for request to storage.
- [ ] Add and configure mongodb.
- [ ] Add `easy-mongo` library/class for easily working with basic calls to mongo.
- [ ] Add `@codixfy/gemini` package for working with gemini ai.
- [ ] Add `@codixfy/ui` and configure it to have react ui components package.

<update-link-of-release-version-tag>

Done!

## üìñ Docs

### Folders Structure

```html
<root>
  |
  |__ <src>
  |     |__ <app>
  |     |     |__ <api>
  |     |     |    |__ route.ts
  |     |     |__ page.tsx
  |     |     |__ layout.tsx
  |     |__ <components>
  |     |        |__ <core>
  |     |        |      |__ demo.tsx
  |     |        |__ <functional>
  |     |        |        |__ demo.tsx
  |     |        |__ <server>
  |     |               |__ demo.tsx
  |     |__ <context>
  |     |      |__ demo.ts
  |     |__ <hooks>
  |     |      |__ demo.ts
  |     |__ <libs>
  |     |      |__ demo.ts
  |     |__ <services>
  |     |      |__ demo.ts
  |     |__ <tests>
  |            |__ <__bench__>
  |            |       |__ demo.bench.ts
  |            |__ demo.test.ts
  |__ .demo.env
  |__ .env.local
  |__ package.json
```

## Getting Started
### Github Actions

This project does run 2 github workflows: `validator` and `preview`

#### Code Validator Workflow

This workflow will run all the tests to ensure the project meet the guidelines and common coding structure.

After running this workflow, you will make sure that:

- The code formatting meets the repository standards.
- The code passed the lint test, so no coding errors are present.
- The code has passed all the test suits.
- The code has 100% coverage. You can opt-out this by removing or commenting the last 2 lines on the `.github/workflows/validator.yml` file.

#### Preview Deployment Workflow

This workflow will ensure that the code builds correctly, and will provide a preview deployment at Vercel, so you can check how everything is rendering.

**How to setup**
1. You must go to [Vercel](https://vercel.com/), login and create a new project, and deploy it.
2. Go to your github repository setting.
3. Go to `secrets and variables/actions/new repository secret`, and add the following variables:
  - `VERCEL_ORG_ID`: On your account settings/general, under VERCEL ID name.
  - `VERCEL_PROJECT_ID`: On your project settings, under the same name.
  - `VERCEL_TOKEN`:  On your account settings/tokens, you must create a new one.

### Project Config & SEO

#### Config.ts

There is a file called `config.ts` at the route `.src/` which contain all the values for the project information, it is important that you fill them up, because they are used in some other components, including `@/components/SEO.ts`, the object that gives all the SEO metadata at the root layout.

#### SEO

We have added SEO automatically to the root layout, you can check them by opening the `@/components/seo.ts` file. However, there are some configurations you must follow for an optimized SEO.

1. Go to `public/robots.txt` and add all the robots url rules.
2. Go to `public/manifest.json` and create the manifest for your site.
3. Add all the icons you set on the manifest to the `/public/icons/` folder.
4. Create a cover image for the social media, change its name to `og.png` and save it on the `/public/` folder.
5. You are all set with SEO for the homepage, you can use the same SEO object on other pages layouts, or create your own custom based on the structure of that `ROOT_SEO` object.

## Components
### Light/Dark Theme

This project have implemented the light and dark theme, which you can manipulate using the `useTheme()` react hook, or using the `ThemeSwitcher` button component at `@/components/functional/ThemeSwitcher.tsx`.

#### Theme Context & Provider

Is the provider that will handle the current theme on the application, save the selected theme on the local storage, and load the theme from the storage/match prefer-color-scheme if first visit.

It is located at `@/contexts/themeContext` and it does have exports:
- `ThemeProvider`: The provider that must wrap all the application.
- `useTheme`: The react hook that will allow you to recover and set the current theme.

<br />

> [!IMPORTANT]
> The provider must wrap the whole application, so we added it at the root layout. If you remove it, the hook and helper component will not be able to switch themes.

#### ThemeSwitcher React Component

This button uses the `useTheme` hook to switch the current theme when clicked.

You can just use it anywhere in the app and will switch the current theme. Usage:

```tsx
import { ThemeSwitcher } from "@/components/functional/ThemeSwitch"

export default function Home() {
	return (
		<main>
			<p>Home Page</p>
      <ThemeSwitcher />
		</main>
	);
}
```

##### Styling
If you want to style the button or create a new one, check the src code.

## Custom Hooks & Libraries
These are some custom hooks and libraries added to the project to solve efficiently some common issues and tasks when developing a full stack web application.

### CryptoHash
**Type**: Library

**What's the goal?**
- `Create an encrypted hash` from a plain text. Useful when encrypting the passwords before saving them at the database.
- `Compare encrypted hash` using a plain text. Used when comparing if the password from an user is the same as the one encrypted in the database.
- `Create UUID` useful when creating id for database, or any other service.
- `Create two steps authentication codes` useful to validate if the user is really who is trying to login, verify emails, etc.

#### Methods
Use `async CryptoHash.hashString()` to encrypt any `string` value.
```ts
import { CryptoHash } from "@/libs/CryptoHash"

async function encrypt() {
    const encrypted = await CryptoHash.hashString("<text to encrypt>")
    console.log(encrypted)
}

encrypt()
```

Use `async CryptoHash.compareString()` to compare a plain text with a given hash.

```ts
import { CryptoHash } from "@/libs/CryptoHash"

async function compare() {
    const comparison = await CryptoHash.compareString("<plain text to compare>", "<your hash>")
    console.log(comparison)
}

compare()
```

Use `CryptoHash.getRandomUUID()` to get a random UUID formatted value.

```ts
import { CryptoHash } from "@/libs/CryptoHash"

const uuid = CryptoHash.getRandomUUID()

console.log(uuid)
```

Use `CryptoHash.get2StepsVerificationCode()` to get a random 6 characters code uppercased.

```ts
import { CryptoHash } from "@/libs/CryptoHash"

const code = CryptoHash.get2StepsVerificationCode()

console.log(code)
```

### DataValidation
**Type**: Library

**What's the goal?**
- `Validate data types & structure` to ensure your data is being pass as expected and avoid unexpected errors at runtime.

#### Methods
Use `DataValidation.validateEmail()` to validate that a string is an email.
```ts
import { DataValidation } from "@/libs/DataValidator"

console.log(DataValidator.validateEmail("<your likely email>"))
```

Use `DataValidation.validatePassword()` to validate that a password meet the minimum security criteria such as:
- At least 8 characters long
- At least an upper case letter
- At least a number
- At least an special character

```ts
import { DataValidation } from "@/libs/DataValidator"

console.log(DataValidator.validatePassword("<your password>"))
```

Use `DataValidation.validateObject()` to match an object structure and value types with a provided schema.

```ts
import { DataValidation } from "@/libs/DataValidator"

const schema = {
  name: "string",
  age: "number",
  other: {
    isUser: "boolean"
  }
}

const exampleObj = {
  name: "Jonathan",
  age: 22,
  other: {
    isUser: true
  }
}

console.log(DataValidator.validateObject(exampleObj, schema))
```

### useViewport
**Type**: React Hook

**What's the goal?**
- `Handle window resize events` getting the current width and height for responsible designs or minimum/maximum sizes requirements.

#### How to use?
Use `useViewport` to get real-time width and height values
```tsx
"use client"

import { useViewport } from "@/hooks/useViewport"

function TestComponent() {
  const { width, height } = useViewport()

  return (
    <div>
      <p>Current width: {width}, Current height: {height}</p>
    </div>
  )
}
```

## Clerk Auth

Clerk auth is the authentication provider we do use.

### Usage
1. Go to [Clerk Website](https://clerk.com/) and create a new account.
2. Create a new project/app and configure it.
3. Copy and paste all the clerk-related enviromental variable names from `demo.env` to `.env.local`
4. Get your public and priivate keys from `Clerk Dashboard/API Keys`.
5. Add your custom onboarding by following the official [docs](https://clerk.com/docs/guides/add-onboarding-flow).

> [!CAUTION]
> Do **not** share your private key with anyone.

See all the pages on `src/auth` to know how to use it, or read the official docs.

### How to remove

1. Uninistall the package using:
```bash
pnpm remove @clerk/nextjs
```

2. Remove from the `src/middleware.ts` file with following content:

Note: If that all the file contain, then delete the file completely.

```ts
import { clerkMiddleware } from "@clerk/nextjs/server";

export default clerkMiddleware();

export const config = {
	matcher: ["/((?!.*\\..*|_next).*)", "/", "/(api|trpc)(.*)"],
};

```

3. Go to the root layout at `/src/app/layout.tsx` and remove the `<ClerkProvider>` tags from the code, and the importation of it.

```tsx
import { ThemeProvider } from "@/contexts/themeContext";

<ClerkProvider>
  {...}
</ClerkProvider>
```

4. Go to `/src/app/page.tsx` and remove the following code:

```tsx
import {
	SignInButton,
	SignUpButton,
	SignedIn,
	SignedOut,
	UserButton,
} from "@clerk/nextjs";

<SignedOut>
	<h1>You are currently signed out, please sign in:</h1>
	<br />
	<SignInButton />
	<SignUpButton />
</SignedOut>
<SignedIn>
	<h1>You are currently signed in.</h1>
	<br />
	Profile: <UserButton /> <br />
	<a href="/auth/protected-client">Protected Page (Client)</a> <br />
	<a href="/auth/protected-server">Protected Page (Server)</a> <br />
</SignedIn>
```

5. Remove the folder `src/app/auth` completely.